$(function(){function $(){for(var t=[],e=0;e<arguments.length;e++){var i=arguments[e];if("string"==typeof i&&(i=document.getElementById(i)),1==arguments.length)return i;t[t.length]=i}return t}var scripts=document.getElementsByTagName("script"),myscript=scripts[scripts.length-1],undefined="undefined",EmptyFunc=function(){},Class={create:function(){return function(){this.initialize&&this.initialize.apply(this,arguments)}}};window.TickerList=[],Function.prototype.bind=function(t){var e=this;return function(){e.apply(t,arguments)}},typeof Function.prototype.apply==undefined&&(Function.prototype.apply=function(object,parameters){var parameterStrings=[];object||(object=window),parameters||(parameters=[]);for(var i=0;i<parameters.length;i++)parameterStrings[i]="parameters["+i+"]";object.__apply__=this;var result=eval("object.__apply__("+parameterStrings.join(", ")+")");return object.__apply__=null,result});var HLComm=Class.create();HLComm.prototype={initialize:function(url){var frame,container;if("x"!="".replace(/^$/,function(){return"x"})){var div=document.createElement("div");with(div.style)height=width=border="0px",visibility="hidden",position="absolute";document.body.appendChild(div),div.innerHTML='<iframe src=""></iframe>',frame=div.firstChild,container=div}else frame=document.createElement("iframe"),document.body.appendChild(frame),container=frame;with(container.style)height=width=border="0px",visibility="hidden",position="absolute";for(var i=0;i<window.frames.length;i++)if(window.frames[i]==frame){frame=window.frames[i];break}this.frame=frame,this.url=url},sendRealRequest:function(t){var e,i=this.frame;return i.contentDocument?e=i.contentDocument:i.contentWindow?e=i.contentWindow.document:i.document&&(e=i.document),e?(e.open(),e.write('<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><script type="text/javascript" >var xmlstring = {};</script><script type="text/javascript" src="'+this.url+"\"></script></head><body onLoad=\"var d='';try{d=xmlstring}catch(e){}window.parent.TickerList["+t+'].handleResponse(d);"></body></html>'),void e.close()):void setTimeout(function(){arguments.callee(t)},100)}},window.Ticker=Class.create(),Ticker.prototype={tickingPeriod:12e4,downloadInterval:119e3,updateInterval:59,startPercent:99,tickStep:0,tickerStartSum:0,tickerEndSum:0,tickerStartTime:0,ticking:!0,counter:0,errmsg:"-",xml:"",downloadTime:0,type:"",setup:!1,initialize:function(t){if(t.info){switch(this.currency=t.currency?t.currency.toLowerCase():"usd",this.info=t.info,this.xml=t.root_url?t.root_url:myscript.src.replace(/jackpots\/new_jackpotjs.js.*/,""),this.xml+="jpdata/datalink/",t.info){case 1:if(!t.game||1==t.local&&!t.casino)return;this.countElement="game",t.casino&&(this.casino=t.casino.toLowerCase()),this.game=t.game.toLowerCase(),this.xml+=1==t.local?this.casino+"_":"",this.xml+=this.game,this.setup=!0;break;case 2:if(!t.casino)return;this.countElement="casinototal",this.casino=t.casino.toLowerCase(),this.xml+=this.casino,this.setup=!0;break;case 4:this.xml+="casinostotal",this.local=1==t.local||0==t.local?t.local:2,this.setup=!0;break;case 5:if(!t.group)return;this.countElement="game",this.group=t.group.toLowerCase(),this.xml+="group_"+this.group,this.setup=!0;break;default:return}this.xml+=".xml.js",this.setup=!0,("count"==t.type||"sum"==t.type)&&(this.ticking=!1,this.type=t.type,"count"==this.type&&(this.sign="",this.signpos="")),this.comm=new HLComm(this.xml),this.name=window.TickerList.length,window.TickerList[window.TickerList.length]=this}},attachToTextBox:function(t){this.textbox=$(t)},debugTextBox:function(t){this.debug=$(t)},SetCurrencySign:function(t){"count"!=this.type&&(this.sign=t)},SetCurrencyPos:function(t){"count"!=this.type&&(this.signpos=t)},requestJackpot:function(){this.comm.sendRealRequest(this.name)},handleResponse:function(t){this.errmsg="-";var e,i,s=this.tickerEndSum,r=0,n=0,a=t.endTime-t.startTime+60*t.execInterval+180;if(this.downloadInterval=1e3*a,this.tickingPeriod=this.downloadInterval+6e4,e=this.parseFromString(t.jpxml))if(4==this.info&&2==this.local){var o=this.findTargetNodes(e);if(o&&o.length>0){s=0;for(var c=0;c<o.length;c++){var h=o[c],u=0;"sum"==this.type?u=parseFloat(h.getAttribute("wins"),10):"count"==this.type?u=parseFloat(h.getAttribute("winc"),10):h.firstChild&&h.firstChild.nodeValue&&(u=parseFloat(h.firstChild.nodeValue,10)),isNaN(u)||(s+=u),r+=isNaN(parseFloat(h.getAttribute("seed"),10))?0:parseFloat(h.getAttribute("seed"),10),n+=isNaN(parseFloat(h.getAttribute("step"),10))?0:parseFloat(h.getAttribute("step"),10)}0==s&&(s=this.tickerEndSum),"undefined"==typeof this.sign&&(this.sign=o[0].getAttribute("sign"),3==this.sign.length&&(this.sign=" "+this.currency.toUpperCase(),this.signpos=1)),"undefined"==typeof this.signpos&&(this.signpos=o[0].getAttribute("pos"))}}else i=this.findTargetNode(e),i&&("sum"==this.type?s=parseFloat(i.getAttribute("wins"),10):"count"==this.type?s=parseFloat(i.getAttribute("winc"),10):i.firstChild&&i.firstChild.nodeValue&&(s=parseFloat(i.firstChild.nodeValue,10)),isNaN(s)&&(s=this.tickerEndSum),"undefined"==typeof this.sign&&(this.sign=i.getAttribute("sign"),3==this.sign.length&&(this.sign=" "+this.currency.toUpperCase(),this.signpos=1)),"undefined"==typeof this.signpos&&(this.signpos=i.getAttribute("pos")),r=parseFloat(i.getAttribute("seed"),10),n=parseFloat(i.getAttribute("step"),10),isNaN(r)&&(r=0),isNaN(n)&&(n=0));this.setJackpot(s,r,n)},findTargetNodes:function(t){var e=t,i=[];if("count"==this.type)return t.getElementsByTagName("total");for(var s=e.getElementsByTagName("amount"),r=0;r<s.length;r++)s[r].getAttribute("currency").toLowerCase()==this.currency&&i.push(s[r]);return i},findTargetNode:function(t){var e,i=t;if(4==this.info){for(var s=!1,r=t.getElementsByTagName("total"),n=0;n<r.length;n++)r[n].getAttribute("local")==this.local&&(i=r[n],s=!0);if(!s)return!1;if("count"==this.type)return i}if("count"==this.type)e=i.getElementsByTagName(this.countElement)[0];else for(var a=i.getElementsByTagName("amount"),n=0;n<a.length;n++)if(a[n].getAttribute("currency").toLowerCase()==this.currency){e=a[n];break}return e},parseFromString:function(t){var e={};if("undefined"!=typeof DOMParser)var e=(new DOMParser).parseFromString(t,"text/xml");else try{e=new ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.loadXML(t)}catch(i){e.err=1,e.errmsg=i}return""==t||1==e.err?(this.errormsg=e.errmsg,!1):e},setJackpot:function(t,e,i){this.tickerEndSum=t;var s=this.getJackpot(),r=Math.round(this.tickingPeriod/this.updateInterval*1e11)/1e11;if(i>0?(this.tickerStartSum=Math.max(this.tickerEndSum-i*this.tickingPeriod/1e3,this.tickerEndSum*this.startPercent/100,e),this.tickerStartSum=Math.max(this.tickerStartSum,s),this.tickStep=Math.min(i,(this.tickerEndSum-this.tickerStartSum)/r)):(this.tickerStartSum=this.tickerEndSum*this.startPercent/100,this.tickerStartSum=Math.max(this.tickerStartSum,s),this.tickStep=(this.tickerEndSum-this.tickerStartSum)/r),this.tickerStartTime=(new Date).getTime(),this.debug){var n="";1==this.info&&(n+="GameTicker: "+this.game+"/"+(this.casino?this.casino:"global")+"/"+this.currency),2==this.info&&(n+="CasinoTicker: "+this.casino+"/"+this.currency),4==this.info&&(n+="TotalTicker: "+(2==this.local?"(local+global) ":1==this.local?"(local) ":"global ")+this.currency),5==this.info&&(n+="GroupTicker: "+this.group+"/"+this.currency),this.type&&(n+=" - "+this.type),this.debug.innerHTML="-"==this.errmsg?n+"<br>StartSum: "+this.tickerStartSum+"<br>EndSum: "+this.tickerEndSum+"<br>TickingPeriod: "+this.tickingPeriod+"<br>TickingStep: "+this.tickStep+"<br>"+this.xml:n+"<br>"+this.errmsg+"<br>counter: "+this.counter}},getJackpot:function(){var t=(new Date).getTime();if(0==this.tickerStartTime)return 0;if(!this.ticking)return this.tickerEndSum;var e=(t-this.tickerStartTime)/this.updateInterval;return this.tickerStartSum+e*this.tickStep},updateJackpot:function(){var t=(new Date).getTime();return 0==this.counter?(navigator&&navigator.userAgent&&-1!=navigator.userAgent.toLowerCase().indexOf("opera")&&setTimeout(this.requestJackpot.bind(this),100),this.counter=this.counter+1,this.downloadTime=t,setTimeout(this.requestJackpot.bind(this),500),void this.requestJackpot()):t>this.downloadTime+this.downloadInterval?(this.counter=this.counter+1,this.downloadTime=t,void this.requestJackpot()):!1},showJackpot:function(){var t=this.getJackpot();"count"!=this.type&&(t=Math.round(100*t)/100+"",t.match(/^\d+\.\d$/)&&(t+="0"),t.match(/^\d+$/)&&(t+=".00"));var e="UPDATING";t>0&&(e=0!=this.signpos?t+this.sign:this.sign+t),t>0&&"count"==this.type&&(e=t),this.textbox.innerHTML=e},tick:function(){return this.setup&&this.textbox?0==this.tickerStartTime||this.ticking?(this.updateJackpot(),this.showJackpot(),void setTimeout(this.tick.bind(this),this.updateInterval)):(this.showJackpot(),!1):!1}}});