$(function(){!function(t){t.dialog=function(e){var n={},o={disableMask:!1,maskColor:"#000",maskAlpha:60,zIndex:100,place:t("body"),initWidth:300,initHeight:200,supportAnimate:!0,staytime:5e3},s=t.extend(!0,o,e),r=function(){return t('<div class="J_diaolog_layout" />').html('<!--[if lte IE 6.5]><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;filter:mask();"></iframe><![endif]-->').css("z-index",s.zIndex)}(),a=function(){return s.disableMask?null:t('<div class="J_diaolog_mask" />').css({backgroundColor:s.maskColor,opacity:s.maskAlpha/100}).hide()}(),d=[],h=null;s.supportAnimate&&t.fn.extend({animateCss:function(e){var i="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend";t(this).addClass("animated "+e).one(i,function(){t(this).removeClass("animated "+e)})}}),a&&r.append(a),s.place.append(r);var u=function(e,i){var o=e;if(0===arguments.length)return t.extend({},s);if("string"==typeof e){if(void 0===i)return s[e];o={},o[e]=i}return c(o,s),r.css({zIndex:s.zIndex}),a&&a.css({zIndex:s.zIndex,backgroundColor:s.maskColor,opacity:s.maskAlpha/100}),n},c=function(e,i){t.each(e,function(t,e){i[t]=e})},p=function(e){r.is(":hidden")&&r.show();var i={drag:!0,zoomed:!0,type:"dialog",title:"提示",width:"auto",height:"auto",name:"J_diaolig_popup_"+ +new Date,btnText:["确 定","取 消"],resize:!0,showLoader:!1,closeAfter:e.closeAfter||function(){},minsize:{width:s.initWidth,height:s.initHeight},staytime:s.staytime,zIndex:d.length+1},e=e||{};return e.btnText&&"[object Array]"!==Object.prototype.toString.call(e.btnText)&&(e.btnText=[e.btnText]),t.extend(i.btnText,e.btnText),m(t.extend(!0,i,e))},l=function(t){if(t){if("string"!=typeof t)return;if("*"===t)for(var e in d)d[e].destroy();else{if(!d[t])return;d[t].destroy()}}else d[d.length-1].destroy()},m=function(t){var e=new i(t);return d[t.name]=e,d.push(e),a&&a.css("zIndex",t.zIndex).show(),e},f=function(e,i){var n,o;if("function"==typeof i&&(o=i(),o&&(n=t.inArray(o,d),n>-1))){delete d[o.options.name],d.splice(n,1);var s=0,h=d.length;if(h>0){for(;h>s;s++)d[s].option({zIndex:s+1});return void(a&&a.css("z-index",h))}a&&a.hide(),r.hide()}},g=function(t){if(h){var e=t.clientX-h.offsetX,i=t.clientY-h.offsetY;h.disableSelection(r).fn(t,e,i,_)}},_=function(){if(h){var e=new t.Event("dragstop.dialog");h.enableSelection(r).dom.trigger(e,h),h=null}},v=function(t,e){h=e};return r.bind("destroy.dialog",f),r.bind("mousemove.dialog",g),r.bind("mouseup.dialog",_),r.on("dragstart.dialog",".J_diaolog_popup",v),n.dom=r,n.option=u,n.open=p,n.mask=a,n.instances=d,n.close=l,n}();var e=null,i=function(i){var n=this;this.width=i.width,this.height=i.height,this.options=i,this.dom=this.createEl(this.options).css({zIndex:i.zIndex}),this.status={},this._events={},this.container={dom:t(".J_popup_container",n.dom),html:function(t){this.dom.html(t),n.status.height=this.dom.outerHeight(),n.status.width=this.dom.outerWidth(),n.options.minsize.width="auto"===n.options.width?n.status.width:n.options.minsize.width,n.options.minsize.height="auto"===n.options.height?n.status.height:n.options.minsize.height,n.dom.trigger("complete.dialog",{dom:n.dom})}},this.dom.animateCss("zoomIn"),t.dialog.dom.append(this.dom),n._clearTimer(e),"message"===i.type&&(e=setTimeout(function(){n.dom.find(".J_popup_close").click()},i.staytime)),this._setPosition(this.dom),this.dom.on("click.dialog",".J_popup_close, .J_popup_maximize, .J_popup_restore, .J_popup_confirm, .J_popup_cancel",t.proxy(this,"_clickHandler")),this.dom.bind("complete.dialog",function(e){n._setPosition(t(e.target))}),this.dom.on("mousedown.dialog",".J_popup_hd, .J_popup_resize_hand",t.proxy(this,"_mousedownHandler")),this.dom.bind("dragstop.dialog",t.proxy(this,"dragstopHandler")),this.container.html(i.content),i.onReady&&this.ready(i.onReady)};i.prototype={createEl:function(e){e.width="number"==typeof e.width?e.width+"px":e.width,e.height="number"==typeof e.height?e.height+"px":e.height;var i='<table class="J_popup_main">';return i+=e.title&&"string"==typeof e.title?'<tr><td class="'+(e.drag?"J_popup_hd":"J_popup_nodrag_hd")+'"><h3>'+e.title+"</h3></td></tr>":'<tr><td class="'+(e.drag?"J_popup_hd":"J_popup_nodrag_hd")+' J_popup_hd_notitle"></td></tr>',i+='<tr class="J_popup_bd"><td class="J_popup_bd_main"><div class="J_popup_container" style="width:'+e.width+";height:"+e.height+';">',i+=e.showLoader?'<div class="J_popup_loading"></div></div>':'<div style="width:'+e.minsize.width+"px;height:"+e.minsize.height+'px;"></div></div>',"dialog"!==e.type&&"message"!==e.type&&(i+='<div class="J_popup_btn_wrap" style="display:none"><button class="J_popup_confirm">'+e.btnText[0]+"</button>",("confirm"===e.type||"prompt"===e.type)&&(i+='<button class="J_popup_cancel">'+e.btnText[1]+"</button>"),i+="</div>"),i+='</td></tr><tr><td class="J_popup_ft"></td></tr></table><a href="javascript:;" class="J_popup_close"></a>',"alert"!==e.type&&"confirm"!==e.type&&"message"!==e.type&&(e.resize&&(i+='<s class="J_popup_resize_hand"></s>'),e.zoomed&&(i+='<a href="javascript:;" class="J_popup_maximize"></a>')),t('<div class="J_diaolog_popup" name="'+e.name+'">').html(i)},option:function(e,i){var n=e;if(0===arguments.length)return t.extend({},this.options);if("string"==typeof e){if(void 0===i)return this.options[e];n={},n[e]=i}return this._setOptions(n,this.options),this._render(n),this},_setOptions:function(e,i){t.each(e,function(t,e){i[t]=e})},_render:function(e){this.dom.css({zIndex:e.zIndex}),t(".J_popup_hd h1",this.dom).html(e.title),this.container.dom.css({width:e.width,height:e.height})},_setPosition:function(e){var i=this;i.status.top=(t.dialog.dom.innerHeight()-e.outerHeight())/2,i.status.left=(t.dialog.dom.innerWidth()-e.outerWidth())/2,e.css({top:i.status.top,left:i.status.left})},_clickHandler:function(e){var i=this,n=e.target.className.split("_"),o=new t.Event(n[2]+".dialog");this._methodEntry(e,o,n[2],function(){i.dom.trigger(o,i)})},_methodEntry:function(t,e,i,n){return!n&&t.isDefaultPrevented()?!1:(n(),void(this._queue(e)&&("maximize"===i||"restore"===i?this["_"+i](t):this._closeWindow(t))))},_maximize:function(e){var i=t.dialog.dom.innerHeight()-(this.dom.height()-this.container.dom.innerHeight()),n=t.dialog.dom.innerWidth()-(this.dom.width()-this.container.dom.innerWidth());this.dom.css({top:0,left:0}).find("s.J_popup_resize_hand").hide(),this.container.dom.innerHeight(i).innerWidth(n),t(e.target).removeClass().addClass("J_popup_restore")},_restore:function(e){this.dom.css({top:this.status.top,left:this.status.left}).find("s.J_popup_resize_hand").show(),this.container.dom.innerHeight(this.status.height).innerWidth(this.status.width),t(e.target).removeClass().addClass("J_popup_maximize")},_closeWindow:function(){var t=this;this.dom.animateCss("zoomOut"),setTimeout(function(){t.destroy(),t.options.closeAfter()},200)},_queue:function(t){var e,i=0,n=this._events[t.type]?this._events[t.type].length:0;if(n>0)for(;n>i;i++)if(e=this._events[t.type][i](t,this),e===!1||t.isDefaultPrevented())return;return!0},_mousedownHandler:function(e){var i=this,n=e.target.nodeName;if("A"!==n){var o=new t.Event("dragstart.dialog"),s=i.dom[0],r="S"===n?{container:i.container.dom,offsetX:e.clientX,offsetY:e.clientY,fn:function(t,e,n){var o=i.options.minsize.width,s=i.options.minsize.height,r=e+i.status.width,a=n+i.status.height;return i.container.dom.innerWidth(o>r?o:r).innerHeight(s>a?s:a),i}}:{offsetX:e.clientX-s.offsetLeft,offsetY:e.clientY-s.offsetTop,fn:function(e,n,o,s){var r=0,a=t.dialog.dom.innerHeight()-t(".J_popup_hd",i.dom).outerHeight(),d=0-i.dom.outerWidth()/2,h=t.dialog.dom.innerWidth()-i.dom.outerWidth()/2;return i.dom.css({top:r>o?r:o>a?a:o,left:d>n?d:n>h?h:n}),(r>o||o>a)&&s&&s(),i}};r.obj=i,r.dom=i.dom,r.disableSelection=function(t){return t.css("user-select","none")[0].onselectstart=function(){return!1},this},r.enableSelection=function(t){return t.css("user-select","")[0].onselectstart=null,this},i.dom.trigger(o,r)}},ready:function(t){return"function"==typeof t&&t(this.container),this},close:function(t){return"function"==typeof t&&(!this._events.close&&(this._events.close=[]),this._events.close.push(t)),this},confirm:function(t){return"function"==typeof t&&(!this._events.confirm&&(this._events.confirm=[]),this._events.confirm.push(t)),this},cancel:function(t){return"function"==typeof t&&(!this._events.cancel&&(this._events.cancel=[]),this._events.cancel.push(t)),this},maximize:function(){return"function"==typeof fn&&(!this._events.maximize&&(this._events.maximize=[]),this._events.maximize.push(fn)),this},restore:function(){return"function"==typeof fn&&(!this._events.restore&&(this._events.restore=[]),this._events.restore.push(fn)),this},destroy:function(){var t=this;if(this.status)for(var i in this.status)delete this.status[i];t._clearTimer(e),e=setTimeout(function(){t.dom.find(".J_popup_close").click()},t.options.staytime),t.dom.trigger("destroy.dialog",function(){return t.dom.off("").remove(),t})},_clearTimer:function(){e&&(clearTimeout(e),e=null)},dragstopHandler:function(e,i){var n=i.dom.position();t.dialog.dom.innerHeight()<=i.dom.outerHeight()&&t.dialog.dom.innerWidth()<=i.dom.outerWidth()||this.saveStatus({left:n.left,top:n.top,width:i.obj.container.dom.outerWidth(),height:i.obj.container.dom.outerHeight()})},saveStatus:function(t){for(var e in t)this.status[e]=t[e]},constructor:i};var n=function(e){"string"==typeof e&&(e={content:e});var i={zoomed:!1,type:"alert",btnText:"确 定",resize:!1,width:500,confirm:function(){},close:function(){},minsize:{width:500,height:"auto"},onReady:function(){}},n=t.extend({},i,e);return n.content='<div class="popup-'+n.type+'">'+n.content+"</div>",t.dialog.open(n).confirm(n.confirm).close(n.close)};n.close=function(t){return this.close(t)},n.ready=function(t){return this.ready(t)};var o=function(e){"string"==typeof e&&(e={content:e});var i={showLoader:!0,type:"confirm",cancel:function(){}},o=t.extend({},i,e);return n(o)};o.cancel=function(t){return this.cancel(t)};var s=function(e){var i={type:"prompt",showLoader:!0,btnText:["确 定","取 消"],resize:!0,width:"auto",height:"auto",minsize:{width:300,height:200}},n=t.extend(i,e);return t.dialog.util.confirm(n)},r=function(e){return e="string"==typeof e?{content:e}:e,e.content=arguments[1]?'<div class="tbm '+arguments[1]+'"><s class="fa fa-check"></s>'+e.content+"</div>":'<div class="tbm">'+e.content+"</div>",t.dialog.open(t.extend({title:"系统",type:"message",width:400,closeAfter:arguments[2]},e))};t.dialog.util={alert:n,confirm:o,prompt:s,message:r}}(jQuery)})